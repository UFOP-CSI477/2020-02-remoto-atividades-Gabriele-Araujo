<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">

    <title>Consumo de combustível</title>
    
</head>
<body>
    <div class="container">
        
        <div class="jumbotron bg-light">
            <h1 class="text-center">Consumo de combustível</h1>
            <p class="lead text-center">Avaliação do consumo de combustível dos seus veículos</p>
        </div>
        
        <div class="form-group">
            <form>
                <div class="row">
                    <div class="col-5">
                        <label  for="combustivel">Quantidade de combustível (litros): </label>
                        <input type="number" step="0.01" min="0.10" name="combustivel" id="combustivel" class="form-control" placeholder="Digite a quantidade de combustível" >
                    </div>
                    <div class="col-5">
                        <label for="quilometros">Quantidade de quilômetros rodados (km): </label>
                        <input type="number" step="0.01" min="0.10" name="quilometros" id="quilometros" class="form-control" placeholder="Digite a quantidade de quilômetros rodados">
                    </div>
                    <div class="col-2 py-2 px-3">
                        <button type="button" class="btn btn-success text-white font-weight-bold border-info border"
                            onclick="inserirConsumo()" id="inserir">INSERIR CONSUMO</button>
                    </div>
            </form>
        </div>
       
        <div class="table-responsive py-2">
            <table id="tabelaConsumo" class="table table-hover table-bordered table-striped">
                <thead class="table-secondary">  
                    <tr class="align-items-center">
                        <th>Combustível (litros)</th>
                        <th>Distância (km)</th>
                        <th>Desempenho aproximado (km/l)</th>
                    </tr>
                </thead>
            </table>
        </div>

        <div class="d-flex justify-content-center py-2">
            <button type="button" class=" btn btn-primary text-white font-weight-bold border-info border mr-2" onclick="finalizar()" id="finalizar">FINALIZAR</button>
            <button type="button" class=" btn btn-secondary text-white font-weight-bold border-info border ml-2" onclick="limpar()" id="limpar">LIMPAR</button>
        </div>

        <div class="table-responsive py-3">
            <table id="tabelaApuracao" class="table table-bordered table-striped border-dark bg-white rounded">
                <thead class="table-secondary">
                    <tr class="align-items-center">
                        <th>Quantidade total de combustível utilizado</th>
                        <th>Quantidade total de quilômetros rodados</th>
                        <th>Média de consumo de combustível</th>
                        <th>Média de quilômetros rodados</th>
                        <th>Média de desempenho em km/l</th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>
    
    <script>
        
        let listaVeiculos = [];

        function consumoVeiculo(combustivel, quilometros, desempenho){
            this.combustivel = combustivel;
            this.quilometros = quilometros;
            this.desempenho = desempenho;
        }
        
        function inserirConsumo(){
            var combustivel = document.getElementById('combustivel');
            var quilometros = document.getElementById('quilometros');
            var desempenho = quilometros/combustivel;
                
                    var linha = document.createElement('tr');
                        linha.insertCell(0).innerHTML = combustivel.value;
                        linha.insertCell(1).innerHTML = quilometros.value;
                        linha.insertCell(2).innerHTML = parseFloat(tempo.value);
                    
                    const veiculo = new consumoVeiculo(combustivel, quilometros, desempenho);
                        listaVeiculos.push(veiculo);
                    
                    document.getElementById('tabelaConsumo').appendChild(linha);
                    document.getElementById('finalizar').disabled = false;
                    nome.value = "";
                    tempo.value = "";
        }

        function finalizar(){
            document.getElementById('finalizar').disabled = true;
            var tempoInicial;
            let linha;
            
            if (listaParticipantes.length > 0) {
                document.getElementById('inserir').disabled = true;
                tempo.disabled = true;
                nome.disabled = true;

                listaParticipantes.sort(
                    function (a, b) {
                        if (a.tempo < b.tempo) {
                            return -1;
                        } else if (a.tempo > b.tempo) {
                            return 1;
                        } else {
                            return 0;
                        }
                    }
                );

                for (var i=0; i<listaParticipantes.length; i++){
                    tempoInicial = listaParticipantes[0].tempo;
                    linha = document.createElement('tr');

                        linha.insertCell(0).innerHTML = i + 1;
                        linha.insertCell(1).innerHTML = listaParticipantes[i].largada;
                        linha.insertCell(2).innerHTML = listaParticipantes[i].nome;
                        linha.insertCell(3).innerHTML = listaParticipantes[i].tempo;
                    
                        if (listaParticipantes[i].tempo === tempoInicial){
                        linha.insertCell(4).innerHTML = "Vencedor!";
                    } else{
                        linha.insertCell(4).innerHTML = "";
                    }
                    
                    document.getElementById('tabelaApuracao').appendChild(linha);
                    document.getElementById('limpar').disabled = false;
                }
            }
        }

        function limpar(){
            location.reload();
        }
    </script>
</body>
</html>